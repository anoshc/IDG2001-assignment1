<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IDG2001 Assignment 1</title>
</head>
<body>
    <h1>File Upload Form</h1>
	<form action="http://127.0.0.1:3000/contacts" method="POST" enctype="multipart/form-data" accept=".vcf, application/vcard, application/x-vcard text/vcard, text/x-vcard">
		<p><input type="file" name="file" id="file"></p>
		<p><input type="submit" value="Upload"></p>
	</form>

    <h2>Download all vcards from the database</h2>
    <!-- <form action="http://127.0.0.1:3000/contacts/vcard" method="GET">
        <p><input type="submit" value="Download" onclick="downloadFile()"></p>
    </form> -->
    <button onclick="downloadFile()">Download Data</button>

<script>

async function downloadFile() {
  console.log("hei");
  // make an AJAX request to fetch the data from the API endpoint
  const response = await fetch("/contacts/vcard");
  const data = await response.json();

  // create a blob with the data
  const blob = new Blob([JSON.stringify(data)], { type: "text/vcard" });

  // create a download link for the blob
  const url = URL.createObjectURL(blob);

  // create a link element and click it to start the download
  const link = document.createElement("a");
  link.href = url;
  link.download = "data.json";
  document.body.appendChild(link);
  link.click();

  // cleanup the URL object
  URL.revokeObjectURL(url);
}

</script>


</body>
</html>